var PriceSpider=function(e){"use strict";var n=v(),r=l("ps-trace",!1),t=["widget","recipe","wtb4"],i=function(e){var n=e.filter((function(e){return t.indexOf(e)>=0}));return n.length?n:["widget"]};function o(){var e=u("ps-library");if(e)return i(e.split(",").map((function(e){return e.trim()})));var n=c("ps-library");return n?i(n.split(",").map((function(e){return e.trim()}))):["widget"]}function a(e,n,r){var t=""+("widget"===e?"":e+"/")+n;return r?t+"/debug/ps-"+e+".js":t+"/ps-"+e+".js"}function s(){for(var e=document.getElementsByTagName("script"),n=0;n<e.length;++n){var r=e[n];if(r.src.indexOf("ps-widget")>=0||r.src.indexOf("ps-loader")>=0)return r.src.substr(0,r.src.lastIndexOf("/")+1)}}function c(e){for(var n=document.getElementsByTagName("script"),r=0;r<n.length;++r){var t=n[r];if(t.src.indexOf("ps-widget")>=0||t.src.indexOf("ps-loader")>=0)return t.getAttribute("data-"+e)||t.getAttribute(e)}}function u(e){for(var n=document.head.getElementsByTagName("meta"),r=0;r<n.length;++r){var t=n[r];if(t.getAttribute("name")===e)return t.getAttribute("content")}}function d(e,r){return u(e)||n[e]||r}function l(e,n){void 0===n&&(n=!1);var r=d(e);if(r){var t=p(r);if(void 0!==t)return t}return n}function v(e,n){void 0===e&&(e=!0),void 0===n&&(n=!0);var r,t={};e&&window.location.search.length>1&&f((r=window.location.search.substring(1)).indexOf("&")>0?r.split("&"):[r],t);n&&window.location.hash&&f((r=window.location.hash.substring(1)).indexOf("&")>0?r.split("&"):[r],t);return t}function p(e){return"true"===(e=e.toLowerCase())||"yes"===e||"false"!==e&&"no"!==e&&void 0}function f(e,n){for(var r=0,t=e;r<t.length;r++){var i=t[r],o=i.indexOf("="),a=o>=0?i.substr(0,o):i,s=o>=0?i.substr(o+1):void 0;a in n||"function"==typeof a?n[a]instanceof Array?n[a].push(s):n[a]=[n[a],s]:n[a]=s}}function g(e,n){var r=document.createElement("script");return r.src=e,r.type="text/javascript",r.charset="UTF-8",function(e,n,r){void 0===n.readyState?(n.onload=function(){return r(null,null)},n.onerror=function(){return r(function(e){var n=new Error("Not found");return n.name="LibraryLoader.loadScript",n.url=e,n.status=404,n}(e),null)}):n.onreadystatechange=function(){"loaded"!=n.readyState&&"complete"!=n.readyState||(n.onreadystatechange=null,r(null,null))};document.body?document.body.appendChild(n):document.head.appendChild(n);return b("GET",e),n}(e,r,n)}function b(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];r&&console.log.apply(console,e)}function m(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];r&&console.error.apply(console,e)}var y,h,w=Object.freeze({__proto__:null,params:n,traceEnabled:r,ensureValidLibrary:i,resolveLibraries:o,buildLibraryPath:a,getCodebaseUrl:s,getScriptParam:c,getMetaParam:u,getParam:d,getParamBoolean:l,getUrlParams:v,parseBoolean:p,parseUrlParams:f,loadScript:g,trace:b,error:m});function P(e,n){h=n,y=g(e,(function(e){e&&n(e,null)}))}function O(e,n){var r=h;y&&y.parentElement.removeChild(y),y=void 0,h=void 0,r&&r(null,n)}var S=Object.freeze({__proto__:null,get element(){return y},get handler(){return h},load:P,onload:O}),x=l("ps-debug",!1),B="https://cdn.pricespider.com/1/",E=s()||B+"lib/",L=parseInt(u("ps-key"))||parseInt(u("ps-account"))||parseInt(c("ps-account"));L?(b("ps-account="+L),function(n,r){P(""+B+n+"/config.js",(function(t,i){t||(e.account=i,e.account.id=n,e.account.version||(e.account.version=null),e.account.configs||(e.account.configs=[]),e.account.versions||(e.account.versions={widget:null,recipe:null,wtb4:null})),r(t,null)}))}(L,(function(n){var r,t,i,a;if(n)m("Unable to load library, failed to load account configuration ps-account="+L,n);else{var s=d("ps-version")||d("ps-widget-version");s?(e.version=s,e.versions={widget:e.version,recipe:d("ps-recipe-version")||(null===(i=e.account.versions)||void 0===i?void 0:i.recipe)||e.version,wtb4:d("ps-wtb4-version")||(null===(a=e.account.versions)||void 0===a?void 0:a.wtb4)||e.version}):(e.version=e.account.version,e.versions={widget:e.version,recipe:d("ps-recipe-version")||(null===(r=e.account.versions)||void 0===r?void 0:r.recipe)||e.version,wtb4:d("ps-wtb4-version")||(null===(t=e.account.versions)||void 0===t?void 0:t.wtb4)||e.version}),_(o())}}))):m("Unable to load library, missing or invalid ps-account meta tag");var _=function(n){e.version?n.forEach((function(n){var r=e.versions[n],t=a(n,r,x);g(""+E+t,(function(e){e?m("Failed to load library ps-version="+r,e):b("Loaded library ps-version="+r)}))})):m("Unable to load library, missing or invalid library version")},U=[];return e.Jsonp=S,e.LibraryLoader=w,e.debug=x,e.deferredWidgets=U,e.insertWidget=function(e){"WidgetBinder"in PriceSpider?PriceSpider.WidgetBinder.insert(e):U.push(e)},e.onload=O,e.rebind=function(){"WidgetBinder"in PriceSpider&&PriceSpider.WidgetBinder.bind()},e}({});
